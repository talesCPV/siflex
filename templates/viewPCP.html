
<template>
    <style>
        .inline textarea{
            width: 97%;
            font-size: 1.4em;
        }

        #btnSave{
            width: 97%;
        }

    </style>
  
    <fieldset>
        <legend id="lgdPCP"></legend>

        <div class="inline">
            <label for="edtFrente">Eq. Frente</label>
            <textarea id="edtFrente" cols="30" rows="10"></textarea>
        </div>
        <div class="inline">
            <label for="edtSuporte">Eq. Suporte</label>
            <textarea id="edtSuporte" cols="30" rows="10"></textarea>
        </div>
        <div class="inline">
            <label for="edtCostura">Costura</label>
            <textarea id="edtCostura" cols="30" rows="10"></textarea>
        </div>
        <div class="inline">
            <label for="edtMontagem">Montagem</label>
            <textarea id="edtMontagem" cols="30" rows="10"></textarea>
        </div> 
        <button id="btnSave">Salvar</button>       
    </fieldset>



</template>
<script>
    const localData = getModalData('viewPCP')

    document.querySelector('#lgdPCP').innerHTML = `${localData.dayweek} - ${dataBR(localData.day)}`
    document.querySelector('#edtFrente').innerHTML = localData.frente != undefined ? localData.frente : ''
    document.querySelector('#edtSuporte').innerHTML = localData.suporte != undefined ? localData.suporte : ''
    document.querySelector('#edtCostura').innerHTML = localData.costura != undefined ? localData.costura : ''
    document.querySelector('#edtMontagem').innerHTML = localData.montagem != undefined ? localData.montagem : ''

    document.querySelector('#btnSave').addEventListener('click',()=>{

        const frente = document.querySelector('#edtFrente').value.toUpperCase().trim()
        const suporte = document.querySelector('#edtSuporte').value.toUpperCase().trim()
        const costura = document.querySelector('#edtCostura').value.toUpperCase().trim()
        const montagem = document.querySelector('#edtMontagem').value.toUpperCase().trim()        

        let myPromisse
        const params = new Object;
            params.id = localData.id == undefined ? 'DEFAULT' : localData.id

        if(frente == ''&& suporte == ''&& costura == ''&& montagem == ''){            
            params.hash = localStorage.getItem('hash');
            myPromisse = queryDB(params,16);
        }else{
            params.data = localData.day.getFormatDate()
            params.suporte = suporte
            params.frente = frente
            params.costura = costura
            params.montagem = montagem
            myPromisse = queryDB(params,15);
        }

        myPromisse.then((resolve)=>{
                closeModal('all')
                openHTML('pcp.html','content-screen')
            })
    })

</script>